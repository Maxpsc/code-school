# æ»‘é›ªé—®é¢˜è¯¦è§£

## é—®é¢˜æè¿°

ç»™å®šä¸€ä¸ª R è¡Œ C åˆ—çš„çŸ©é˜µï¼Œè¡¨ç¤ºä¸€ä¸ªçŸ©å½¢åŒºåŸŸçš„é«˜åº¦ã€‚ä½ å¯ä»¥ä»ä»»æ„ä½ç½®å‡ºå‘ï¼Œæ¯æ¬¡å¯ä»¥å‘**ä¸Šä¸‹å·¦å³**å››ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œä½†åªèƒ½ç§»åŠ¨åˆ°æ¯”å½“å‰ä½ç½®**é«˜åº¦æ›´ä½**çš„ä½ç½®ã€‚

**æ±‚ï¼šæœ€é•¿çš„æ»‘é›ªè·¯å¾„é•¿åº¦ã€‚**

### ç¤ºä¾‹

è¾“å…¥çŸ©é˜µï¼ˆ5Ã—5ï¼‰ï¼š
```
 1  2  3  4  5
16 17 18 19  6
15 24 25 20  7
14 23 22 21  8
13 12 11 10  9
```

æœ€é•¿è·¯å¾„ï¼š`25 â†’ 24 â†’ 23 â†’ ... â†’ 2 â†’ 1`ï¼Œé•¿åº¦ä¸º **25**

## é—®é¢˜åˆ†æ

### 1. æš´åŠ›è§£æ³•

ä»æ¯ä¸ªä½ç½®å‡ºå‘ï¼ŒDFS æœç´¢æ‰€æœ‰å¯èƒ½çš„è·¯å¾„ï¼Œè®°å½•æœ€é•¿è·¯å¾„ã€‚

**æ—¶é—´å¤æ‚åº¦**ï¼šO(4^(RÃ—C))ï¼ŒæŒ‡æ•°çº§åˆ«ï¼Œéå¸¸æ…¢ï¼

**é—®é¢˜**ï¼šå¤§é‡é‡å¤è®¡ç®—ã€‚ä¾‹å¦‚ï¼Œä» (0,0) å’Œ (0,1) å‡ºå‘éƒ½å¯èƒ½ç»è¿‡ (1,1)ï¼Œä¼šé‡å¤è®¡ç®—ä» (1,1) å‡ºå‘çš„æœ€é•¿è·¯å¾„ã€‚

### 2. åŠ¨æ€è§„åˆ’ä¼˜åŒ–

**å…³é”®è§‚å¯Ÿ**ï¼š
- ä»æŸä¸ªä½ç½®å‡ºå‘çš„æœ€é•¿è·¯å¾„ï¼Œåªä¾èµ–äºå®ƒèƒ½åˆ°è¾¾çš„ç›¸é‚»ä½ç½®çš„æœ€é•¿è·¯å¾„
- è¿™æ˜¯ä¸€ä¸ª**æœ€ä¼˜å­ç»“æ„**
- ä¼šæœ‰**é‡å å­é—®é¢˜**ï¼ˆåŒä¸€ä¸ªä½ç½®ä¼šè¢«å¤šæ¬¡è®¿é—®ï¼‰

## åŠ¨æ€è§„åˆ’è§£æ³•

### æ­¥éª¤ 1ï¼šå®šä¹‰çŠ¶æ€

```
dp[i][j] = ä»ä½ç½® (i, j) å‡ºå‘èƒ½æ»‘è¡Œçš„æœ€é•¿è·ç¦»
```

### æ­¥éª¤ 2ï¼šçŠ¶æ€è½¬ç§»æ–¹ç¨‹

```
dp[i][j] = max(dp[nx][ny]) + 1
```

å…¶ä¸­ `(nx, ny)` æ˜¯ä» `(i, j)` å¯ä»¥åˆ°è¾¾çš„ç›¸é‚»ä½ç½®ï¼ˆé«˜åº¦æ›´ä½ï¼‰ã€‚

### æ­¥éª¤ 3ï¼šè¾¹ç•Œæ¡ä»¶

å¦‚æœå‘¨å›´æ²¡æœ‰æ›´ä½çš„ä½ç½®ï¼Œ`dp[i][j] = 1`ï¼ˆåªåŒ…å«å½“å‰ä½ç½®ï¼‰

### æ­¥éª¤ 4ï¼šè®¡ç®—é¡ºåº

å¯ä»¥ä½¿ç”¨**è®°å¿†åŒ–æœç´¢**ï¼ˆè‡ªé¡¶å‘ä¸‹ï¼‰æˆ–**æ‹“æ‰‘æ’åº**ï¼ˆè‡ªåº•å‘ä¸Šï¼‰

## æ–¹æ³• 1ï¼šè®°å¿†åŒ–æœç´¢

### æ€è·¯

ä»æ¯ä¸ªä½ç½®å¼€å§‹ DFSï¼Œç”¨ memo æ•°ç»„è®°å½•å·²ç»è®¡ç®—è¿‡çš„ç»“æœã€‚

### ä»£ç å®ç°

```typescript
function skiingMemoization(heights: number[][]): number {
  const rows = heights.length;
  const cols = heights[0].length;
  
  // memo[i][j] = -1 è¡¨ç¤ºæœªè®¡ç®—
  const memo: number[][] = Array.from({ length: rows }, 
    () => new Array(cols).fill(-1)
  );
  
  // å››ä¸ªæ–¹å‘ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³
  const directions = [[-1, 0], [1, 0], [0, -1], [0, 1]];
  
  function dfs(row: number, col: number): number {
    // å¦‚æœå·²ç»è®¡ç®—è¿‡ï¼Œç›´æ¥è¿”å›
    if (memo[row][col] !== -1) {
      return memo[row][col];
    }
    
    // åˆå§‹åŒ–ä¸º 1ï¼ˆè‡³å°‘åŒ…å«å½“å‰ä½ç½®ï¼‰
    let maxLen = 1;
    
    // å°è¯•å››ä¸ªæ–¹å‘
    for (const [dr, dc] of directions) {
      const newRow = row + dr;
      const newCol = col + dc;
      
      // æ£€æŸ¥è¾¹ç•Œå’Œé«˜åº¦æ¡ä»¶
      if (
        newRow >= 0 && newRow < rows &&
        newCol >= 0 && newCol < cols &&
        heights[newRow][newCol] < heights[row][col]
      ) {
        // é€’å½’è®¡ç®—ï¼Œå–æœ€å¤§å€¼
        maxLen = Math.max(maxLen, dfs(newRow, newCol) + 1);
      }
    }
    
    // è®°å½•ç»“æœ
    memo[row][col] = maxLen;
    return maxLen;
  }
  
  // éå†æ‰€æœ‰ä½ç½®ï¼Œæ‰¾åˆ°æœ€é•¿è·¯å¾„
  let maxLength = 0;
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      maxLength = Math.max(maxLength, dfs(i, j));
    }
  }
  
  return maxLength;
}
```

### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(R Ã— C)ï¼Œæ¯ä¸ªä½ç½®åªè®¡ç®—ä¸€æ¬¡
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(R Ã— C)ï¼Œmemo æ•°ç»„ + é€’å½’æ ˆ

## æ–¹æ³• 2ï¼šåŠ¨æ€è§„åˆ’ï¼ˆæ‹“æ‰‘æ’åºï¼‰

### æ€è·¯

æŒ‰ç…§é«˜åº¦ä»ä½åˆ°é«˜çš„é¡ºåºå¤„ç†æ‰€æœ‰ä½ç½®ï¼Œè¿™æ ·è®¡ç®— dp[i][j] æ—¶ï¼Œæ‰€æœ‰å®ƒèƒ½åˆ°è¾¾çš„ä½ç½®éƒ½å·²ç»è®¡ç®—è¿‡äº†ã€‚

### ä»£ç å®ç°

```typescript
function skiingDP(heights: number[][]): number {
  const rows = heights.length;
  const cols = heights[0].length;
  
  // dp[i][j] åˆå§‹åŒ–ä¸º 1
  const dp: number[][] = Array.from({ length: rows }, 
    () => new Array(cols).fill(1)
  );
  
  // åˆ›å»ºä½ç½®åˆ—è¡¨å¹¶æŒ‰é«˜åº¦æ’åºï¼ˆä»ä½åˆ°é«˜ï¼‰
  const positions: Array<[number, number, number]> = [];
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      positions.push([i, j, heights[i][j]]);
    }
  }
  positions.sort((a, b) => a[2] - b[2]);
  
  const directions = [[-1, 0], [1, 0], [0, -1], [0, 1]];
  
  // ä»ä½åˆ°é«˜å¤„ç†æ¯ä¸ªä½ç½®
  for (const [row, col] of positions) {
    for (const [dr, dc] of directions) {
      const newRow = row + dr;
      const newCol = col + dc;
      
      // ä»å½“å‰ä½ç½®å¯ä»¥æ»‘åˆ°æ›´ä½çš„ä½ç½®
      if (
        newRow >= 0 && newRow < rows &&
        newCol >= 0 && newCol < cols &&
        heights[newRow][newCol] < heights[row][col]
      ) {
        dp[row][col] = Math.max(dp[row][col], dp[newRow][newCol] + 1);
      }
    }
  }
  
  // æ‰¾åˆ°æœ€å¤§å€¼
  let maxLength = 0;
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      maxLength = Math.max(maxLength, dp[i][j]);
    }
  }
  
  return maxLength;
}
```

### å¤æ‚åº¦åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(R Ã— C Ã— log(R Ã— C))ï¼Œæ’åºçš„æ—¶é—´
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(R Ã— C)

## æ–¹æ³•å¯¹æ¯”

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|-----------|-----------|------|------|
| è®°å¿†åŒ–æœç´¢ | O(RÃ—C) | O(RÃ—C) | ä»£ç ç®€æ´ï¼Œæ€è·¯è‡ªç„¶ | é€’å½’æ ˆå¼€é”€ |
| åŠ¨æ€è§„åˆ’ | O(RÃ—CÃ—log(RÃ—C)) | O(RÃ—C) | æ— é€’å½’å¼€é”€ | éœ€è¦æ’åº |

## å¯è§†åŒ–ç¤ºä¾‹

### ç¤ºä¾‹ï¼š3Ã—3 çŸ©é˜µ

è¾“å…¥ï¼š
```
9  8  7
6  5  4
3  2  1
```

DP è¡¨æ ¼ï¼ˆä»æ¯ä¸ªä½ç½®å‡ºå‘çš„æœ€é•¿è·¯å¾„ï¼‰ï¼š
```
9  8  7
8  7  6
7  6  5
6  5  4
5  4  3
4  3  2
3  2  1
```

æœ€é•¿è·¯å¾„ï¼šä» (0,0) å‡ºå‘ï¼Œé•¿åº¦ä¸º 9

è·¯å¾„ï¼š`9 â†’ 8 â†’ 7 â†’ 6 â†’ 5 â†’ 4 â†’ 3 â†’ 2 â†’ 1`

## æ‰©å±•ï¼šè·¯å¾„è¿½è¸ª

å¦‚æœéœ€è¦è¾“å‡ºå®Œæ•´è·¯å¾„ï¼Œå¯ä»¥åœ¨è®¡ç®— dp çš„åŒæ—¶è®°å½•æ¯ä¸ªä½ç½®çš„ä¸‹ä¸€æ­¥ã€‚

```typescript
function skiingWithPath(heights: number[][]): {
  maxLength: number;
  path: Array<[number, number]>;
} {
  // ... è®¡ç®— dp ...
  
  // æ‰¾åˆ°èµ·ç‚¹
  let startRow = 0, startCol = 0, maxLength = 0;
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      if (dp[i][j] > maxLength) {
        maxLength = dp[i][j];
        startRow = i;
        startCol = j;
      }
    }
  }
  
  // é‡å»ºè·¯å¾„
  const path: Array<[number, number]> = [];
  let row = startRow, col = startCol;
  path.push([row, col]);
  
  while (dp[row][col] > 1) {
    // æ‰¾åˆ°ä¸‹ä¸€ä¸ªä½ç½®ï¼ˆdp å€¼å‡ 1 ä¸”é«˜åº¦æ›´ä½ï¼‰
    for (const [dr, dc] of directions) {
      const newRow = row + dr;
      const newCol = col + dc;
      
      if (
        newRow >= 0 && newRow < rows &&
        newCol >= 0 && newCol < cols &&
        heights[newRow][newCol] < heights[row][col] &&
        dp[newRow][newCol] === dp[row][col] - 1
      ) {
        path.push([newRow, newCol]);
        row = newRow;
        col = newCol;
        break;
      }
    }
  }
  
  return { maxLength, path };
}
```

## å…³é”®è¦ç‚¹

1. **çŠ¶æ€å®šä¹‰**ï¼š`dp[i][j]` è¡¨ç¤ºä» `(i,j)` å‡ºå‘çš„æœ€é•¿è·¯å¾„
2. **çŠ¶æ€è½¬ç§»**ï¼š`dp[i][j] = max(dp[ç›¸é‚»æ›´ä½ä½ç½®]) + 1`
3. **è®°å¿†åŒ–**ï¼šé¿å…é‡å¤è®¡ç®—ï¼Œå°†æ—¶é—´å¤æ‚åº¦ä»æŒ‡æ•°çº§é™åˆ°çº¿æ€§
4. **è®¡ç®—é¡ºåº**ï¼šå¯ä»¥ç”¨è®°å¿†åŒ–æœç´¢æˆ–æ‹“æ‰‘æ’åº

## ç»ƒä¹ é¢˜

1. ä¿®æ”¹é—®é¢˜ï¼šå¦‚æœå¯ä»¥å‘æ›´é«˜çš„ä½ç½®ç§»åŠ¨ï¼Œå¦‚ä½•æ±‚è§£ï¼Ÿ
2. ä¿®æ”¹é—®é¢˜ï¼šå¦‚æœå¯ä»¥æ–œå‘ç§»åŠ¨ï¼ˆ8ä¸ªæ–¹å‘ï¼‰ï¼Œå¦‚ä½•æ±‚è§£ï¼Ÿ
3. ä¿®æ”¹é—®é¢˜ï¼šå¦‚æœæ¯ä¸ªä½ç½®æœ‰ä¸åŒçš„åˆ†æ•°ï¼Œæ±‚æœ€å¤§åˆ†æ•°è·¯å¾„ï¼Ÿ

## ä¸‹ä¸€æ­¥

ç°åœ¨ä½ å·²ç»æŒæ¡äº†æ»‘é›ªé—®é¢˜ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å­¦ä¹ æ›´ç»å…¸çš„**èƒŒåŒ…é—®é¢˜**ã€‚

ğŸ‘‰ ç»§ç»­é˜…è¯» `03-èƒŒåŒ…é—®é¢˜.md`
