# èƒŒåŒ…é—®é¢˜è¯¦è§£

èƒŒåŒ…é—®é¢˜æ˜¯åŠ¨æ€è§„åˆ’ä¸­æœ€ç»å…¸çš„é—®é¢˜ä¹‹ä¸€ã€‚æœ¬æ–‡å°†è¯¦ç»†è®²è§£ä¸‰ç§èƒŒåŒ…é—®é¢˜ã€‚

## é—®é¢˜èƒŒæ™¯

ä½ æœ‰ä¸€ä¸ªèƒŒåŒ…ï¼Œå®¹é‡æœ‰é™ã€‚æœ‰å¾ˆå¤šç‰©å“å¯ä»¥é€‰æ‹©ï¼Œæ¯ä¸ªç‰©å“æœ‰é‡é‡å’Œä»·å€¼ã€‚å¦‚ä½•é€‰æ‹©ç‰©å“ï¼Œä½¿å¾—èƒŒåŒ…ä¸­ç‰©å“çš„æ€»ä»·å€¼æœ€å¤§ï¼Ÿ

## ä¸€ã€0-1 èƒŒåŒ…é—®é¢˜

### é—®é¢˜æè¿°

æœ‰ N ä¸ªç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸º W çš„èƒŒåŒ…ã€‚ç¬¬ i ä¸ªç‰©å“çš„é‡é‡æ˜¯ `weight[i]`ï¼Œä»·å€¼æ˜¯ `value[i]`ã€‚

**é™åˆ¶**ï¼šæ¯ä¸ªç‰©å“**åªèƒ½é€‰æ‹©ä¸€æ¬¡**ï¼ˆè¦ä¹ˆé€‰ï¼Œè¦ä¹ˆä¸é€‰ï¼‰

**ç›®æ ‡**ï¼šæ±‚èƒŒåŒ…èƒ½è£…å…¥ç‰©å“çš„æœ€å¤§ä»·å€¼ã€‚

### ç¤ºä¾‹

```
èƒŒåŒ…å®¹é‡ï¼š10
ç‰©å“åˆ—è¡¨ï¼š
  ç‰©å“1: é‡é‡=2, ä»·å€¼=3
  ç‰©å“2: é‡é‡=3, ä»·å€¼=4
  ç‰©å“3: é‡é‡=4, ä»·å€¼=5
  ç‰©å“4: é‡é‡=5, ä»·å€¼=8
```

æœ€ä¼˜æ–¹æ¡ˆï¼šé€‰æ‹©ç‰©å“ 2ã€3ã€4ï¼Œæ€»é‡é‡ = 3+4+5 = 12 > 10ï¼ˆè¶…é‡ï¼‰
å®é™…æœ€ä¼˜ï¼šé€‰æ‹©ç‰©å“ 2ã€4ï¼Œæ€»é‡é‡ = 8ï¼Œæ€»ä»·å€¼ = 12

### åŠ¨æ€è§„åˆ’è§£æ³•

#### æ­¥éª¤ 1ï¼šå®šä¹‰çŠ¶æ€

```
dp[i][w] = å‰ i ä¸ªç‰©å“ï¼ŒèƒŒåŒ…å®¹é‡ä¸º w æ—¶çš„æœ€å¤§ä»·å€¼
```

#### æ­¥éª¤ 2ï¼šçŠ¶æ€è½¬ç§»æ–¹ç¨‹

å¯¹äºç¬¬ i ä¸ªç‰©å“ï¼Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š

1. **ä¸é€‰**ï¼š`dp[i][w] = dp[i-1][w]`
2. **é€‰**ï¼š`dp[i][w] = dp[i-1][w-weight[i]] + value[i]`ï¼ˆå‰ææ˜¯ `w >= weight[i]`ï¼‰

å–ä¸¤è€…çš„æœ€å¤§å€¼ï¼š

```
dp[i][w] = max(
  dp[i-1][w],                           // ä¸é€‰ç¬¬ i ä¸ªç‰©å“
  dp[i-1][w-weight[i]] + value[i]       // é€‰ç¬¬ i ä¸ªç‰©å“
)
```

#### æ­¥éª¤ 3ï¼šè¾¹ç•Œæ¡ä»¶

```
dp[0][w] = 0  // æ²¡æœ‰ç‰©å“æ—¶ï¼Œä»·å€¼ä¸º 0
dp[i][0] = 0  // èƒŒåŒ…å®¹é‡ä¸º 0 æ—¶ï¼Œä»·å€¼ä¸º 0
```

#### æ­¥éª¤ 4ï¼šè®¡ç®—é¡ºåº

ä» `i=1` åˆ° `i=N`ï¼Œä» `w=0` åˆ° `w=W`

### ä»£ç å®ç°ï¼ˆäºŒç»´ï¼‰

```typescript
function knapsack01_2D(
  items: Array<{ weight: number; value: number }>,
  capacity: number
): number {
  const n = items.length;
  
  // åˆ›å»º DP è¡¨æ ¼
  const dp: number[][] = Array.from({ length: n + 1 }, 
    () => new Array(capacity + 1).fill(0)
  );
  
  // å¡«å…… DP è¡¨æ ¼
  for (let i = 1; i <= n; i++) {
    const { weight, value } = items[i - 1];
    
    for (let w = 0; w <= capacity; w++) {
      // ä¸é€‰ç¬¬ i ä¸ªç‰©å“
      dp[i][w] = dp[i - 1][w];
      
      // å¦‚æœèƒ½é€‰ç¬¬ i ä¸ªç‰©å“ï¼Œå–æœ€å¤§å€¼
      if (w >= weight) {
        dp[i][w] = Math.max(dp[i][w], dp[i - 1][w - weight] + value);
      }
    }
  }
  
  return dp[n][capacity];
}
```

**å¤æ‚åº¦**ï¼š
- æ—¶é—´ï¼šO(N Ã— W)
- ç©ºé—´ï¼šO(N Ã— W)

### ç©ºé—´ä¼˜åŒ–ï¼ˆä¸€ç»´ï¼‰

**è§‚å¯Ÿ**ï¼š`dp[i][w]` åªä¾èµ– `dp[i-1][w]` å’Œ `dp[i-1][w-weight[i]]`

å¯ä»¥ç”¨ä¸€ç»´æ•°ç»„ï¼Œ**ä»åå¾€å‰**æ›´æ–°ï¼š

```typescript
function knapsack01_1D(
  items: Array<{ weight: number; value: number }>,
  capacity: number
): number {
  const dp: number[] = new Array(capacity + 1).fill(0);
  
  for (const { weight, value } of items) {
    // âš ï¸ å…³é”®ï¼šä»åå¾€å‰éå†
    for (let w = capacity; w >= weight; w--) {
      dp[w] = Math.max(dp[w], dp[w - weight] + value);
    }
  }
  
  return dp[capacity];
}
```

**ä¸ºä»€ä¹ˆè¦ä»åå¾€å‰ï¼Ÿ**

å› ä¸º `dp[w]` ä¾èµ– `dp[w-weight]`ï¼Œå¦‚æœä»å‰å¾€åï¼Œ`dp[w-weight]` å·²ç»è¢«æ›´æ–°äº†ï¼ˆç›¸å½“äºåŒä¸€ç‰©å“è¢«ä½¿ç”¨äº†å¤šæ¬¡ï¼‰ã€‚

**å¤æ‚åº¦**ï¼š
- æ—¶é—´ï¼šO(N Ã— W)
- ç©ºé—´ï¼šO(W) âœ…

### DP è¡¨æ ¼ç¤ºä¾‹

ç‰©å“ï¼š`[(2,3), (3,4), (4,5)]`ï¼Œå®¹é‡ï¼š5

```
     w=0  w=1  w=2  w=3  w=4  w=5
i=0   0    0    0    0    0    0
i=1   0    0    3    3    3    3   (ç‰©å“1: é‡2å€¼3)
i=2   0    0    3    4    4    7   (ç‰©å“2: é‡3å€¼4)
i=3   0    0    3    4    5    7   (ç‰©å“3: é‡4å€¼5)
```

æœ€å¤§ä»·å€¼ï¼š`dp[3][5] = 7`ï¼ˆé€‰æ‹©ç‰©å“ 1 å’Œ 2ï¼‰

---

## äºŒã€å®Œå…¨èƒŒåŒ…é—®é¢˜

### é—®é¢˜æè¿°

æœ‰ N **ç§**ç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸º W çš„èƒŒåŒ…ã€‚ç¬¬ i ç§ç‰©å“çš„é‡é‡æ˜¯ `weight[i]`ï¼Œä»·å€¼æ˜¯ `value[i]`ã€‚

**é™åˆ¶**ï¼šæ¯ç§ç‰©å“å¯ä»¥é€‰æ‹©**æ— é™æ¬¡**

**ç›®æ ‡**ï¼šæ±‚èƒŒåŒ…èƒ½è£…å…¥ç‰©å“çš„æœ€å¤§ä»·å€¼ã€‚

### ä¸ 0-1 èƒŒåŒ…çš„åŒºåˆ«

- 0-1 èƒŒåŒ…ï¼šæ¯ä¸ªç‰©å“åªèƒ½é€‰ä¸€æ¬¡
- å®Œå…¨èƒŒåŒ…ï¼šæ¯ä¸ªç‰©å“å¯ä»¥é€‰æ— é™æ¬¡

### åŠ¨æ€è§„åˆ’è§£æ³•

#### çŠ¶æ€å®šä¹‰

```
dp[i][w] = å‰ i ç§ç‰©å“ï¼ŒèƒŒåŒ…å®¹é‡ä¸º w æ—¶çš„æœ€å¤§ä»·å€¼
```

#### çŠ¶æ€è½¬ç§»æ–¹ç¨‹

```
dp[i][w] = max(
  dp[i-1][w],                    // ä¸é€‰ç¬¬ i ç§ç‰©å“
  dp[i][w-weight[i]] + value[i]  // é€‰ç¬¬ i ç§ç‰©å“ï¼ˆæ³¨æ„æ˜¯ dp[i]ï¼Œä¸æ˜¯ dp[i-1]ï¼‰
)
```

**å…³é”®åŒºåˆ«**ï¼šé€‰æ‹©ç‰©å“æ—¶ç”¨ `dp[i][w-weight[i]]`ï¼Œå› ä¸ºå¯ä»¥é‡å¤é€‰æ‹©ã€‚

### ä»£ç å®ç°ï¼ˆäºŒç»´ï¼‰

```typescript
function knapsackComplete_2D(
  items: Array<{ weight: number; value: number }>,
  capacity: number
): number {
  const n = items.length;
  const dp: number[][] = Array.from({ length: n + 1 }, 
    () => new Array(capacity + 1).fill(0)
  );
  
  for (let i = 1; i <= n; i++) {
    const { weight, value } = items[i - 1];
    
    for (let w = 0; w <= capacity; w++) {
      dp[i][w] = dp[i - 1][w];
      
      if (w >= weight) {
        // âš ï¸ æ³¨æ„è¿™é‡Œæ˜¯ dp[i][w - weight]ï¼Œä¸æ˜¯ dp[i-1][w - weight]
        dp[i][w] = Math.max(dp[i][w], dp[i][w - weight] + value);
      }
    }
  }
  
  return dp[n][capacity];
}
```

### ç©ºé—´ä¼˜åŒ–ï¼ˆä¸€ç»´ï¼‰

å®Œå…¨èƒŒåŒ…çš„ä¸€ç»´ä¼˜åŒ–æ›´ç®€å•ï¼Œ**ä»å‰å¾€å**éå†ï¼š

```typescript
function knapsackComplete_1D(
  items: Array<{ weight: number; value: number }>,
  capacity: number
): number {
  const dp: number[] = new Array(capacity + 1).fill(0);
  
  for (const { weight, value } of items) {
    // âš ï¸ å…³é”®ï¼šä»å‰å¾€åéå†
    for (let w = weight; w <= capacity; w++) {
      dp[w] = Math.max(dp[w], dp[w - weight] + value);
    }
  }
  
  return dp[capacity];
}
```

**ä¸ºä»€ä¹ˆè¦ä»å‰å¾€åï¼Ÿ**

å› ä¸ºå¯ä»¥é‡å¤é€‰æ‹©åŒä¸€ç‰©å“ï¼Œæ‰€ä»¥ `dp[w]` å¯ä»¥ä¾èµ–å·²ç»æ›´æ–°è¿‡çš„ `dp[w-weight]`ã€‚

### 0-1 èƒŒåŒ… vs å®Œå…¨èƒŒåŒ…

| ç‰¹æ€§ | 0-1 èƒŒåŒ… | å®Œå…¨èƒŒåŒ… |
|------|---------|---------|
| ç‰©å“é™åˆ¶ | æ¯ä¸ªåªèƒ½é€‰ä¸€æ¬¡ | æ¯ä¸ªå¯é€‰æ— é™æ¬¡ |
| äºŒç»´è½¬ç§» | `dp[i-1][w-weight]` | `dp[i][w-weight]` |
| ä¸€ç»´éå† | **ä»åå¾€å‰** | **ä»å‰å¾€å** |

**è®°å¿†å£è¯€**ï¼š
- 0-1 èƒŒåŒ…ï¼š**å€’ç€æ¥**ï¼ˆé¿å…é‡å¤ä½¿ç”¨ï¼‰
- å®Œå…¨èƒŒåŒ…ï¼š**æ­£ç€æ¥**ï¼ˆå…è®¸é‡å¤ä½¿ç”¨ï¼‰

---

## ä¸‰ã€å¤šé‡èƒŒåŒ…é—®é¢˜

### é—®é¢˜æè¿°

æœ‰ N ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡ä¸º W çš„èƒŒåŒ…ã€‚ç¬¬ i ç§ç‰©å“çš„é‡é‡æ˜¯ `weight[i]`ï¼Œä»·å€¼æ˜¯ `value[i]`ï¼Œæ•°é‡æ˜¯ `count[i]`ã€‚

**é™åˆ¶**ï¼šæ¯ç§ç‰©å“æœ€å¤šé€‰æ‹© `count[i]` æ¬¡

**ç›®æ ‡**ï¼šæ±‚èƒŒåŒ…èƒ½è£…å…¥ç‰©å“çš„æœ€å¤§ä»·å€¼ã€‚

### æœ´ç´ è§£æ³•

#### çŠ¶æ€è½¬ç§»æ–¹ç¨‹

```
dp[i][w] = max(dp[i-1][w - k*weight[i]] + k*value[i])
```

å…¶ä¸­ `k = 0, 1, 2, ..., min(count[i], w/weight[i])`

#### ä»£ç å®ç°

```typescript
function knapsackMultiple(
  items: Array<{ weight: number; value: number; count: number }>,
  capacity: number
): number {
  const n = items.length;
  const dp: number[][] = Array.from({ length: n + 1 }, 
    () => new Array(capacity + 1).fill(0)
  );
  
  for (let i = 1; i <= n; i++) {
    const { weight, value, count } = items[i - 1];
    
    for (let w = 0; w <= capacity; w++) {
      // å°è¯•é€‰æ‹© k ä¸ªç¬¬ i ç§ç‰©å“
      const maxK = Math.min(count, Math.floor(w / weight));
      
      for (let k = 0; k <= maxK; k++) {
        dp[i][w] = Math.max(
          dp[i][w],
          dp[i - 1][w - k * weight] + k * value
        );
      }
    }
  }
  
  return dp[n][capacity];
}
```

**å¤æ‚åº¦**ï¼šO(N Ã— W Ã— K)ï¼ŒK æ˜¯ç‰©å“æ•°é‡

### äºŒè¿›åˆ¶ä¼˜åŒ–

**æ€è·¯**ï¼šå°†æ¯ç§ç‰©å“æ‹†åˆ†æˆå¤šä¸ª 0-1 èƒŒåŒ…ç‰©å“ã€‚

ä¾‹å¦‚ï¼š`count = 10`ï¼Œæ‹†åˆ†æˆ `1, 2, 4, 3`ï¼ˆäºŒè¿›åˆ¶è¡¨ç¤ºï¼‰

è¿™æ ·å¯ä»¥ç”¨æ›´å°‘çš„ç‰©å“è¡¨ç¤ºæ‰€æœ‰å¯èƒ½çš„æ•°é‡ï¼ˆ0~10ï¼‰ã€‚

#### ä»£ç å®ç°

```typescript
function knapsackMultipleOptimized(
  items: Array<{ weight: number; value: number; count: number }>,
  capacity: number
): number {
  // å°†å¤šé‡èƒŒåŒ…ç‰©å“æ‹†åˆ†æˆ 0-1 èƒŒåŒ…ç‰©å“
  const expandedItems: Array<{ weight: number; value: number }> = [];
  
  for (const { weight, value, count } of items) {
    let remaining = count;
    let k = 1;
    
    // äºŒè¿›åˆ¶æ‹†åˆ†
    while (k <= remaining) {
      expandedItems.push({
        weight: weight * k,
        value: value * k,
      });
      remaining -= k;
      k *= 2;
    }
    
    // å¤„ç†å‰©ä½™éƒ¨åˆ†
    if (remaining > 0) {
      expandedItems.push({
        weight: weight * remaining,
        value: value * remaining,
      });
    }
  }
  
  // ä½¿ç”¨ 0-1 èƒŒåŒ…æ±‚è§£
  return knapsack01_1D(expandedItems, capacity);
}
```

**å¤æ‚åº¦**ï¼šO(N Ã— W Ã— log K) âœ…

---

## ä¸‰ç§èƒŒåŒ…é—®é¢˜å¯¹æ¯”

| ç±»å‹ | é™åˆ¶ | çŠ¶æ€è½¬ç§» | ä¸€ç»´éå†æ–¹å‘ | æ—¶é—´å¤æ‚åº¦ |
|------|------|---------|-------------|-----------|
| 0-1 èƒŒåŒ… | æ¯ä¸ªé€‰ä¸€æ¬¡ | `dp[i-1][w-weight]` | ä»åå¾€å‰ | O(NÃ—W) |
| å®Œå…¨èƒŒåŒ… | æ— é™æ¬¡ | `dp[i][w-weight]` | ä»å‰å¾€å | O(NÃ—W) |
| å¤šé‡èƒŒåŒ… | æœ€å¤š count æ¬¡ | æ‹†åˆ†æˆ 0-1 | ä»åå¾€å‰ | O(NÃ—WÃ—logK) |

## è·¯å¾„è¿½è¸ª

å¦‚æœéœ€è¦çŸ¥é“é€‰æ‹©äº†å“ªäº›ç‰©å“ï¼Œå¯ä»¥åœ¨äºŒç»´ DP çš„åŸºç¡€ä¸Šå›æº¯ï¼š

```typescript
function knapsack01WithPath(
  items: Array<{ weight: number; value: number }>,
  capacity: number
): { maxValue: number; selectedItems: number[] } {
  const n = items.length;
  const dp: number[][] = Array.from({ length: n + 1 }, 
    () => new Array(capacity + 1).fill(0)
  );
  
  // å¡«å…… DP è¡¨æ ¼
  for (let i = 1; i <= n; i++) {
    const { weight, value } = items[i - 1];
    for (let w = 0; w <= capacity; w++) {
      dp[i][w] = dp[i - 1][w];
      if (w >= weight) {
        dp[i][w] = Math.max(dp[i][w], dp[i - 1][w - weight] + value);
      }
    }
  }
  
  // å›æº¯æ‰¾å‡ºé€‰æ‹©çš„ç‰©å“
  const selectedItems: number[] = [];
  let w = capacity;
  
  for (let i = n; i > 0; i--) {
    // å¦‚æœ dp[i][w] != dp[i-1][w]ï¼Œè¯´æ˜é€‰æ‹©äº†ç¬¬ i ä¸ªç‰©å“
    if (dp[i][w] !== dp[i - 1][w]) {
      selectedItems.push(i - 1);
      w -= items[i - 1].weight;
    }
  }
  
  selectedItems.reverse();
  
  return {
    maxValue: dp[n][capacity],
    selectedItems,
  };
}
```

## å…³é”®è¦ç‚¹æ€»ç»“

1. **çŠ¶æ€å®šä¹‰**ï¼š`dp[i][w]` è¡¨ç¤ºå‰ i ä¸ªç‰©å“ï¼Œå®¹é‡ w çš„æœ€å¤§ä»·å€¼
2. **0-1 èƒŒåŒ…**ï¼šæ¯ä¸ªç‰©å“é€‰æˆ–ä¸é€‰ï¼Œä¸€ç»´æ•°ç»„**ä»åå¾€å‰**
3. **å®Œå…¨èƒŒåŒ…**ï¼šæ¯ä¸ªç‰©å“å¯é€‰æ— é™æ¬¡ï¼Œä¸€ç»´æ•°ç»„**ä»å‰å¾€å**
4. **å¤šé‡èƒŒåŒ…**ï¼šäºŒè¿›åˆ¶æ‹†åˆ†ä¼˜åŒ–ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦
5. **ç©ºé—´ä¼˜åŒ–**ï¼šäºŒç»´ â†’ ä¸€ç»´ï¼ŒèŠ‚çœç©ºé—´

## ç»ƒä¹ é¢˜

1. LeetCode 416: åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆ0-1 èƒŒåŒ…å˜å½¢ï¼‰
2. LeetCode 322: é›¶é’±å…‘æ¢ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰
3. LeetCode 518: é›¶é’±å…‘æ¢ IIï¼ˆå®Œå…¨èƒŒåŒ…è®¡æ•°ï¼‰
4. LeetCode 474: ä¸€å’Œé›¶ï¼ˆäºŒç»´ 0-1 èƒŒåŒ…ï¼‰

## ä¸‹ä¸€æ­¥

æ­å–œä½ å®Œæˆäº†èƒŒåŒ…é—®é¢˜çš„å­¦ä¹ ï¼æ¥ä¸‹æ¥æŸ¥çœ‹æ€»ç»“æ–‡æ¡£ã€‚

ğŸ‘‰ ç»§ç»­é˜…è¯» `04-æ€»ç»“ä¸ç»ƒä¹ .md`
